---
title: "Precision, Recall и в чем их разница"
date: 2024-05-28T21:22:20+07:00
---

# Что такое Precision и Recall?
Оба два - это метрики классификации, которые показывают, насколько хорошо модель предсказывает классы.

# Что такое Precision
Предположим у нас есть два класса: X и O. И предположим на плоскости они расположены следующим образом:
![Значения на графике](/images/precision_recall_01.png)
Затем мы обучили модель предсказывать эти два класса и она разделила их фиолетовой чертой как на картинке ниже. По ее мнению справа находятся X'ы, а слева - O'и.
![Разделение значений на графике](/images/precision_recall_02.png)
Теперь нас интересует, как мы можем оценить Precision для класса X.
Формула Precision'a для оценки качества предсказаний модели по классу X будет следующей:
$$
Precision = \frac{\text{Количество правильно предсказанных X}}{\text{Количество всех предсказанных как X}}
$$
В нашем случае Precision = 4/6 = $\frac{2}{3}$
Интересно тут то, что в этой формуле мы не берем во внимание предсказанное как класс O:
![Интересное в формуле precision](/images/precision_recall_03.png)

# Что такое Recall
Обратимся к примеру, который мы рассмотрели выше.
![Разделение значений на графике](/images/precision_recall_02.png)
В этом случае значение Recall для класса X будет считаться следующим образом:
$$
Recall = \frac{\text{Все значения X которые мы предсказали как X}}{\text{Вообще все значения X}}
$$
Recall = 4/6 = $\frac{2}{3}$. В нашем примере получается то же значение.
Здесь интересно то, что для подсчета этой метрики мы игнорируем все значения с классом O:
![Интересное в формуле recall](/images/precision_recall_04.png)

# Зачем их считать, если можно посчитать Accuracy?
В данном случае, возможно посчитать Accuracy было бы достаточно. Accuracy = 7/11 ~= 0.64
Но метрики Precision и Recall показывают себя хорошо в случае, когда имеется дисбаланс классов. И с помощью этих двух метрик мы сможем сконцентрировать внимание именно на желаемом классе.

# Источники
> https://www.youtube.com/watch?v=qWfzIYCvBqo